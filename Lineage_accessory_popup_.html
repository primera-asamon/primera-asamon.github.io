<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>インシグニア表</title>
<!--    <link rel="stylesheet" href="Lineage_skill.css"> -->
  </head>
  <style>
/* モーダル用 */
  .modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5);
}
.modal-content {
  background-color: #fdfdf0;
  margin: 5% auto;
  padding: 1em;
  border: 1px solid #888;
  width: 70%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 0 10px #333;
}
.close-button {
  float: right;
  font-size: 1.5em;
  cursor: pointer;
}
table.lineage_accessory_popup_table {
  border: 1px solid #888;
  font-size: small;
  color: #222;
  text-align:center;
  border-collapse: collapse;
  width: 100%;
}
th {
  border: 1px solid #888;
  background-color: #bfb;
  text-align:center;
  padding: 2px 6px 2px 6px;
  font-weight: normal;
}
td {
  border: 1px solid #888;
  text-align:right;
  padding: 1px 6px 1px 6px;
}
.modal_selection tr {
  display: none;
}
.lineage_accessory_popup_title {
  margin: 0px;
}
.style_regular {
  font-weight: normal;
  font-size: 0.8em;
  color: #555;
}
.lineage_accessory_popup_subtitle {
  margin: 0px;
  font-size: 0.9em;
  color: #555;
}
</style>
<body>
    <div class="lineage_accessory_insignia">インシグニア表<br>
    <ol>
        <li><a href="#" class="record-link" data-key="闘士のインシグニア" title="クリックで詳細表示">闘士のインシグニア</a></li>
        <li><a href="#" class="record-link" data-key="射手のインシグニア" title="クリックで詳細表示">射手のインシグニア</a></li>
        <li><a href="#" class="record-link" data-key="賢者のインシグニア" title="クリックで詳細表示">賢者のインシグニア</a></li>
        <li><a href="#" class="record-link" data-key="守護のインシグニア" title="クリックで詳細表示">守護のインシグニア</a></li>
        <li><a href="#" class="record-link" data-key="闘士の守護インシグニア" title="クリックで詳細表示">闘士の守護インシグニア</a></li>
        <li><a href="#" class="record-link" data-key="射手の守護インシグニア" title="クリックで詳細表示">射手の守護インシグニア</a></li>
        <li><a href="#" class="record-link" data-key="賢者の守護インシグニア" title="クリックで詳細表示">賢者の守護インシグニア</a></li>
    </ol>
    </div>

<script>
// 変数規定部（CONFIGオブジェクトのプロパティとして。必要に応じて変更。）
const CONFIG = {
 // モーダル構成(html末尾)div ID指定(recordModal_1…,recordDetailContainer_1…)
  modalSelector: '#recordModal_1',
  containerSelector: '#recordDetailContainer_1', 
  closeButtonSelector: '.close-button'
};

// SubHTMLのスタイルとタグを記述する。↓はskill一覧表依存、適宜変更する。
/*function generateSubHTML(key) {
  const table = document.createElement('table');
  table.className = 'lineage_accessory_popup_table';

  // ヘッダー行を追加
  table.innerHTML = `
    <thead>
      <tr><th>性能項目</th><th>強化0</th><th>強化1</th><th>強化2</th><th>強化3</th><th>強化4</th><th>強化5</th><th>強化6</th><th>強化7</th><th>強化8</th></tr>
    </thead>
    <tbody></tbody>
  `;

  // 元HTMLから対象trを抽出
  const parser = new DOMParser();
  const doc = parser.parseFromString(generateSubHTML_all(), 'text/html');
  const rows = doc.querySelectorAll(`tr.${key}`);

  const tbody = table.querySelector('tbody');
  rows.forEach(row => {
    tbody.appendChild(row.cloneNode(true));
  });

  return table.outerHTML;
}
*/
// 全部のフィルター前HTML生成関数
function generateSubHTML_all(key) {
  return `
  <h3 class="lineage_accessory_popup_title">${key}<span class="style_regular">の性能</span></h3>
  <span class="lineage_accessory_popup_subtitle">強化値による性能変化一覧</span><br>
  <table class="lineage_accessory_popup_table">
  <thead>
  <tr><th>項目</th><th>強化0</th><th>強化1</th><th>強化2</th><th>強化3</th><th>強化4</th><th>強化5</th><th>強化6</th><th>強化7</th><th>強化8</th></tr>
  </thead>
  <tbody class="modal_selection">
  <tr class="闘士のインシグニア"><th>AC</th><td>0</td><td>0</td><td>0</td><td>0</td><td>-1</td><td>-2</td><td>-3</td><td>-3</td><td>-3</td></tr>
  <tr class="闘士のインシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="闘士のインシグニア"><th>近距離ダメージ</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+3 </td><td>+4 </td></tr>
  <tr class="闘士のインシグニア"><th>近距離クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+3%</td><td>+5%</td></tr>
  <tr class="射手のインシグニア"><th>AC</th><td>0 </td><td>0 </td><td>0 </td><td>0 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-3 </td><td>-3 </td></tr>
  <tr class="射手のインシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="射手のインシグニア"><th>遠距離ダメージ</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+3 </td><td>+4 </td></tr>
  <tr class="射手のインシグニア"><th>遠距離クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+5%</td><td>+5%</td></tr>
  <tr class="賢者のインシグニア"><th>AC</th><td>0 </td><td>0 </td><td>0 </td><td>0 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-3 </td><td>-3 </td></tr>
  <tr class="賢者のインシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="賢者のインシグニア"><th>近距離命中</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+3 </td><td>+4 </td></tr>
  <tr class="賢者のインシグニア"><th>魔法クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+2%</td><td>+4%</td></tr>
  <tr class="守護のインシグニア"><th>AC</th><td>0 </td><td>0 </td><td>0 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-5 </td><td>-6 </td><td>-7 </td></tr>
  <tr class="守護のインシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="守護のインシグニア"><th>ダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+3 </td><td>+4 </td></tr>
  <tr class="守護のインシグニア"><th>MR</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+3 </td><td>+5 </td><td>+7 </td></tr>
  <tr class="闘士の守護インシグニア"><th>AC</th><td>-1 </td><td>-1 </td><td>-1 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-5 </td><td>-6 </td><td>-8 </td></tr>
  <tr class="闘士の守護インシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="闘士の守護インシグニア"><th>近距離ダメージ</th><td></td><td></td><td></td><td></td><td>+1 </td><td>+1 </td><td>+2 </td><td>+3 </td><td>+5 </td></tr>
  <tr class="闘士の守護インシグニア"><th>近距離命中</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+3 </td><td>+5 </td></tr>
  <tr class="闘士の守護インシグニア"><th>ダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+4 </td><td>+6 </td></tr>
  <tr class="闘士の守護インシグニア"><th>PvPダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+5 </td><td>+8 </td></tr>
  <tr class="闘士の守護インシグニア"><th>祝福消耗効率</th><td></td><td></td><td></td><td></td><td></td><td>+5%</td><td>+10%</td><td>+15%</td><td>+20%</td></tr>
  <tr class="闘士の守護インシグニア"><th>近距離クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+3%</td><td>+5%</td></tr>
  <tr class="闘士の守護インシグニア"><th>MR</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+3 </td><td>+8 </td><td>+10 </td></tr>
  <tr class="射手の守護インシグニア"><th>AC</th><td>-1 </td><td>-1 </td><td>-1 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-5 </td><td>-6 </td><td>-8 </td></tr>
  <tr class="射手の守護インシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="射手の守護インシグニア"><th>遠距離ダメージ</th><td></td><td></td><td></td><td></td><td>+1 </td><td>+1 </td><td>+2 </td><td>+3 </td><td>+5 </td></tr>
  <tr class="射手の守護インシグニア"><th>ダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+4 </td><td>+6 </td></tr>
  <tr class="射手の守護インシグニア"><th>PvPダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+5 </td><td>+8 </td></tr>
  <tr class="射手の守護インシグニア"><th>祝福消耗効率</th><td></td><td></td><td></td><td></td><td></td><td>+5%</td><td>+10%</td><td>+15%</td><td>+20%</td></tr>
  <tr class="射手の守護インシグニア"><th>遠距離クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+3%</td><td>+5%</td></tr>
  <tr class="射手の守護インシグニア"><th>MR</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+3 </td><td>+8 </td><td>+10 </td></tr>
  <tr class="射手の守護インシグニア"><th>遠距離命中</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+3 </td><td>+5 </td></tr>
  <tr class="賢者の守護インシグニア"><th>AC</th><td>-1 </td><td>-1 </td><td>-1 </td><td>-1 </td><td>-2 </td><td>-3 </td><td>-5 </td><td>-6 </td><td>-8 </td></tr>
  <tr class="賢者の守護インシグニア"><th>最大HP</th><td>+5 </td><td>+10 </td><td>+15 </td><td>+20 </td><td>+25 </td><td>+30 </td><td>+35 </td><td>+40 </td><td>+50 </td></tr>
  <tr class="賢者の守護インシグニア"><th>近距離命中</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+3 </td><td>+4 </td></tr>
  <tr class="賢者の守護インシグニア"><th>ダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+4 </td><td>+6 </td></tr>
  <tr class="賢者の守護インシグニア"><th>PvPダメージ減少</th><td></td><td></td><td></td><td></td><td></td><td>+1 </td><td>+2 </td><td>+5 </td><td>+8 </td></tr>
  <tr class="賢者の守護インシグニア"><th>祝福消耗効率</th><td></td><td></td><td></td><td></td><td></td><td>+5%</td><td>+10%</td><td>+15%</td><td>+20%</td></tr>
  <tr class="賢者の守護インシグニア"><th>魔法クリティカル</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+1%</td><td>+2%</td><td>+4%</td></tr>
  <tr class="賢者の守護インシグニア"><th>MR</th><td></td><td></td><td></td><td></td><td></td><td></td><td>+3 </td><td>+8 </td><td>+10 </td></tr>
  <tr class="賢者の守護インシグニア"><th>魔法命中</th><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>+2 </td><td>+3 </td></tr>
  </tbody>`
}
// リンククリックイベント
document.addEventListener('click', (e) => {
  if (e.target.classList.contains('record-link')) {
    e.preventDefault();
    const key = e.target.dataset.key;
    showModal(key, generateSubHTML_all);
  }
});
//表示切り替え関数（選択された key に一致する行のみ表示）
/*function filterModalRows(key) {
  const rows = document.querySelectorAll('.modal_selection tr');
  console.log(`Filtering for key: "${key}"`);
  rows.forEach(row => {
    console.log(`Row classList:`, row.classList);
    row.style.display = row.classList.contains(key) ? '' : 'none';
  });
}*/
/*function filterModalRows(key) {
  const container = document.querySelector(CONFIG.containerSelector);
  const rows = container.querySelectorAll('.modal_selection tr');
  console.log(`Filtering for key: "${key}"`);
  rows.forEach(row => {
    console.log(`row.className: [${row.className}]`);
    row.style.display = row.classList.contains(key) ? '' : 'none';
  });
}*/
function filterModalRows(key) {
  const container = document.querySelector(CONFIG.containerSelector);
  const rows = container.querySelectorAll('.modal_selection tr');
  console.log(`Filtering for key: "${key}"`);
  rows.forEach(row => {
    console.log(`row.className: [${row.className}]`);
    row.style.display = row.classList.contains(key) ? 'table-row' : 'none';
  });
}
// モーダル表示関数（filterModalRowsを呼び出し、表示対象のみ可視化）
function showModal(key) {
  console.log(`Container: "${CONFIG.containerSelector}"`);
  const modal = document.querySelector(CONFIG.modalSelector);
  const container = document.querySelector(CONFIG.containerSelector);
  const closeBtn = document.querySelector(CONFIG.closeButtonSelector);
  container.innerHTML = generateSubHTML_all(key); // 全体HTMLを挿入
  setTimeout(() => filterModalRows(key), 0); // 非同期で行フィルタリング＊遅延実行
  console.log(container.innerHTML); // 「<tbody class="modal_selection">」が存在するか確認
  filterModalRows(key);                 // 表示対象のみ可視化
  modal.style.display = 'block';

  closeBtn.onclick = () => modal.style.display = 'none';
  window.onclick = (event) => {
    if (event.target === modal) modal.style.display = 'none';
  };
}
</script>
<!-- ↓モーダル1 -->
    <div id="recordModal_1" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <div id="recordDetailContainer_1"></div>
    </div>
    </div>
<!-- ↑モーダル1 -->
<!-- ↓モーダル2 -->
    <div id="recordModal_2" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <div id="recordDetailContainer_2"></div>
    </div>
    </div>
<!-- ↑モーダル2 -->
</body>
</html>